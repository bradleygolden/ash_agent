# Getting Started with AshAgent

AshAgent is an Ash Framework extension that enables you to build AI agent applications with LLM integration using a declarative DSL.

## Installation

Add `ash_agent` to your list of dependencies in `mix.exs`:

```elixir
def deps do
  [
    {:ash_agent, "~> 0.1.0"}
  ]
end
```

Then run:

```bash
mix deps.get
```

## Quick Start

### 1. Add the Extension to Your Resource

```elixir
defmodule MyApp.Agents.Assistant do
  use Ash.Resource,
    domain: MyApp.Agents,
    extensions: [AshAgent.Resource]

  agent do
    provider :req_llm
    client "anthropic:claude-3-5-sonnet"

    output MyApp.Reply

    prompt ~p"""
    You are a helpful assistant.
    {{ output_format }}
    """
  end

  attributes do
    uuid_primary_key :id
    attribute :name, :string, allow_nil?: false
  end
end
```

### 2. Add the Extension to Your Domain

```elixir
defmodule MyApp.Agents do
  use Ash.Domain,
    extensions: [AshAgent.Domain]

  resources do
    resource MyApp.Agents.Assistant
  end
end
```

### 3. Use the Agent

```elixir
# Create an agent
{:ok, agent} = MyApp.Agents.Assistant
  |> Ash.Changeset.for_create(:create, %{name: "My Assistant"})
  |> Ash.create()
```

## Choosing a Provider

AshAgent separates orchestration from LLM execution. Set `provider` inside your `agent` block (defaults to `:req_llm`):

- `:req_llm` – direct ReqLLM integration; prompt required.
- `:baml` – delegates to ash_baml functions; prompt optional.
- Custom modules – implement `AshAgent.Provider` and register via `config :ash_agent, providers: [...]`.

```elixir
agent do
  provider :baml
  client :support, function: :ChatAgent
  output MyApp.BamlClients.Support.Types.ChatAgent
end
```

Since the BAML provider advertises `:prompt_optional`, you can omit the prompt entirely. Providers lacking that capability (e.g., `:req_llm`) will still enforce a prompt at compile time.

## Next Steps

- Read about [AshAgent concepts](../topics/overview.md)
- Explore the DSL reference (auto-generated by Spark)
- Check out example applications

## Learn More

- [Ash Framework Documentation](https://hexdocs.pm/ash)
- [Spark DSL Documentation](https://hexdocs.pm/spark)
